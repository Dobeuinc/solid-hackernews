import{t,f as e,u as n,s as r,g as o,d as s,a,S as c,h as i,j as u,b as l,k as h,l as d,c as p}from"./index-35c621cc.js";function f(t){return t.split("/").map(m).join("/")}const g=/%|\//g;function m(t){return t.length<3||-1===t.indexOf("%")?t:decodeURIComponent(t).replace(g,encodeURIComponent)}const S=/%(?:2(?:4|6|B|C)|3(?:B|D|A)|40)/g;function y(t){return encodeURIComponent(t).replace(S,decodeURIComponent)}var v;!function(t){t[t.ANY=-1]="ANY",t[t.STAR=42]="STAR",t[t.SLASH=47]="SLASH",t[t.COLON=58]="COLON"}(v||(v={}));const A=/(\/|\.|\*|\+|\?|\||\(|\)|\[|\]|\{|\}|\\)/g,D=Array.isArray,E=Object.prototype.hasOwnProperty;function w(t,e){if("object"!=typeof t||null===t)throw new Error("You must pass an object as the second argument to `generate`.");if(!E.call(t,e))throw new Error("You must provide param `"+e+"` to `generate`.");const n=t[e],r="string"==typeof n?n:""+n;if(0===r.length)throw new Error("You must provide a param `"+e+"`.");return r}var x,C;!function(t){t[t.Static=0]="Static",t[t.Dynamic=1]="Dynamic",t[t.Star=2]="Star",t[t.Epsilon=4]="Epsilon"}(x||(x={})),function(t){t[t.Static=x.Static]="Static",t[t.Dynamic=x.Dynamic]="Dynamic",t[t.Star=x.Star]="Star",t[t.Epsilon=x.Epsilon]="Epsilon",t[t.Named=x.Dynamic|x.Star]="Named",t[t.Decoded=x.Dynamic]="Decoded",t[t.Counted=x.Static|x.Dynamic|x.Star]="Counted"}(C||(C={}));const N=[];N[x.Static]=function(t,e){let n=e;const r=t.value;for(let t=0;t<r.length;t++){const e=r.charCodeAt(t);n=n.put(e,!1,!1)}return n},N[x.Dynamic]=function(t,e){return e.put(v.SLASH,!0,!0)},N[x.Star]=function(t,e){return e.put(v.ANY,!1,!0)},N[x.Epsilon]=function(t,e){return e};const O=[];O[x.Static]=function(t){return t.value.replace(A,"\\$1")},O[x.Dynamic]=function(){return"([^/]+)"},O[x.Star]=function(){return"(.+)"},O[x.Epsilon]=function(){return""};const b=[];b[x.Static]=function(t){return t.value},b[x.Dynamic]=function(t,e,n){const r=w(e,t.value);return n?y(r):r},b[x.Star]=function(t,e){return w(e,t.value)},b[x.Epsilon]=function(){return""};const R=Object.freeze({}),_=Object.freeze([]);function L(t,e,n){e.length>0&&e.charCodeAt(0)===v.SLASH&&(e=e.substr(1));const r=e.split("/");let o=void 0,s=void 0;for(let e=0;e<r.length;e++){let a=r[e],c=0;c=""===a?x.Epsilon:a.charCodeAt(0)===v.COLON?x.Dynamic:a.charCodeAt(0)===v.STAR?x.Star:x.Static,c&C.Named&&(a=a.slice(1),o=o||[],o.push(a),s=s||[],s.push(0!=(c&C.Decoded))),c&C.Counted&&n[c]++,t.push({type:c,value:m(a)})}return{names:o||_,shouldDecodes:s||_}}function j(t,e,n){return t.char===e&&t.negate===n}class Y{constructor(t,e,n,r,o){this.states=t,this.id=e,this.char=n,this.negate=r,this.nextStates=o?e:null,this.pattern="",this._regex=void 0,this.handlers=void 0,this.types=void 0}regex(){return this._regex||(this._regex=new RegExp(this.pattern)),this._regex}get(t,e){const n=this.nextStates;if(null!==n)if(D(n))for(let r=0;r<n.length;r++){const o=this.states[n[r]];if(j(o,t,e))return o}else{const r=this.states[n];if(j(r,t,e))return r}}put(t,e,n){let r;if(r=this.get(t,e))return r;const o=this.states;return r=new Y(o,o.length,t,e,n),o[o.length]=r,null==this.nextStates?this.nextStates=r.id:D(this.nextStates)?this.nextStates.push(r.id):this.nextStates=[this.nextStates,r.id],r}match(t){const e=this.nextStates;if(!e)return[];const n=[];if(D(e))for(let r=0;r<e.length;r++){const o=this.states[e[r]];P(o,t)&&n.push(o)}else{const r=this.states[e];P(r,t)&&n.push(r)}return n}}function P(t,e){return t.negate?t.char!==e&&t.char!==v.ANY:t.char===e||t.char===v.ANY}function U(t,e){let n=[];for(let r=0,o=t.length;r<o;r++){const o=t[r];n=n.concat(o.match(e))}return n}function z(t){let e;t=t.replace(/\+/gm,"%20");try{e=decodeURIComponent(t)}catch(t){e=""}return e}class H{constructor(){const t=[],e=new Y(t,0,v.ANY,!0,!1);t[0]=e,this.rootState=e}static ENCODE_AND_DECODE_PATH_SEGMENTS=!0;static Normalizer={normalizeSegment:m,normalizePath:f,encodePathSegment:y};add(t,e){let n=this.rootState,r="^";const o=[0,0,0],s=new Array(t.length),a=[];let c=!0,i=0;for(let e=0;e<t.length;e++){const u=t[e],{names:l,shouldDecodes:h}=L(a,u.path,o);for(;i<a.length;i++){const t=a[i];t.type!==x.Epsilon&&(c=!1,n=n.put(v.SLASH,!1,!1),r+="/",n=N[t.type](t,n),r+=O[t.type](t))}s[e]={handler:u.handler,names:l,shouldDecodes:h}}c&&(n=n.put(v.SLASH,!1,!1),r+="/"),n.handlers=s,n.pattern=r+"$",n.types=o}recognize(t){const e=H.ENCODE_AND_DECODE_PATH_SEGMENTS;let n,r=[this.rootState],o={},s=!1;const a=t.indexOf("#");-1!==a&&(t=t.substr(0,a));const c=t.indexOf("?");if(-1!==c){const e=t.substr(c+1,t.length);t=t.substr(0,c),o=function(t){const e=t.split("&"),n={};for(let t=0;t<e.length;t++){const r=e[t].split("=");let o=z(r[0]);const s=o.length;let a,c=!1;1===r.length?a="true":(s>2&&o.endsWith("[]")&&(c=!0,o=o.slice(0,s-2),n[o]||(n[o]=[])),a=r[1]?z(r[1]):""),c?n[o].push(a):n[o]=a}return n}(e)}t.startsWith("/")||(t="/"+t);let i=t;e?t=f(t):(t=decodeURI(t),i=decodeURI(i));const u=t.length;u>1&&"/"===t.charAt(u-1)&&(t=t.substr(0,u-1),i=i.substr(0,i.length-1),s=!0);for(let e=0;e<t.length&&(r=U(r,t.charCodeAt(e)),r.length);e++);const l=[];for(let t=0;t<r.length;t++)r[t].handlers&&l.push(r[t]);r=function(t){return t.sort((function(t,e){const[n,r,o]=t.types||[0,0,0],[s,a,c]=e.types||[0,0,0];if(o!==c)return o-c;if(o){if(n!==s)return s-n;if(r!==a)return a-r}return r!==a?r-a:n!==s?s-n:0}))}(l);const h=l[0];return h&&h.handlers&&(s&&h.char===v.ANY&&(i+="/"),n=function(t,e,n,r){const o=t.handlers,s=t.regex();if(!s||!o)throw new Error("state not initialized");const a=s.exec(e);let c=1;const i=function(t){const e=[];return e.queryParams=t||{},e}(n);i.length=o.length;for(let t=0;t<o.length;t++){const e=o[t],n=e.names,s=e.shouldDecodes;let u=R,l=!1;if(n!==_&&s!==_)for(let t=0;t<n.length;t++){l=!0;const e=n[t],o=a&&a[c++];u===R&&(u={}),r&&s[t]?u[e]=o&&decodeURIComponent(o):u[e]=o}i[t]={handler:e.handler,params:u,isDynamic:l}}return i}(h,i,o,e)),n}}const I=t("<a></a>",2),T=p();function k(){return n(T)}function q(t){const e=k(),n=o({},e,{level:e.level+1}),r=s((()=>{const t=e.current;return t&&t[e.level]&&t[e.level].handler.component}),void 0,!0),l=s((()=>{const t=e.current;return t&&t[e.level]&&t[e.level].params}),void 0,!0),h=s((()=>{const t=e.current;return t&&t.queryParams}),void 0,!0),d=()=>{const t=e.current;return t&&t[e.level].handler.data&&t[e.level].handler.data({get params(){return l()},get query(){return h()}})||{}};return a(T.Provider,{value:n,get children(){return a(c,{get when(){return r()},children:e=>{const n=i(d);return a(e,o({get params(){return l()},get query(){return h()}},Object.keys(n).reduce(((t,e)=>(t[e]=()=>n[e],u(t,e))),{}),Object.keys(t).reduce(((e,n)=>(e[n]=()=>t[n],u(e,n))),{}),{}))}})}})}const B=t=>{const e=k();return(()=>{const n=I.cloneNode(!0);return n.__click=n=>{n.preventDefault(),e.push(t.href||"")},r(n,t,!1,!1),n})()},G=t=>{const e=function(t,e,n=""){const r=new H;W(r,t,n);const[o,a]=l(e||window.location.pathname.replace(n,"")+window.location.search),c=s((()=>r.recognize(n+o()))),[i,u]=h();return globalThis.window&&(window.onpopstate=()=>u((()=>a(window.location.pathname.replace(n,""))))),{root:n,get location(){return o()},get current(){return c()},get pending(){return i()},push(t){window.history.pushState("","",n+t),u((()=>a(t)))},addRoutes(t){W(r,t,n)}}}(t.routes,t.initialURL,t.root);return e.level=0,a(T.Provider,{value:e,get children(){return t.children}})};let M={};function W(t,e,n,r=[]){e.forEach((e=>{let o;"string"==typeof e.component?(o=M[e.component],o&&o.data===e.data||(M[e.component]=o={component:d((()=>import(n+e.component))),data:e.data})):o={component:e.component,data:e.data};const s={path:n+e.path,handler:o};if(!e.children)return t.add([...r,s]);W(t,e.children,n,[...r,s])}))}e(["click"]);export{B as L,q as R,G as a,k as u};
