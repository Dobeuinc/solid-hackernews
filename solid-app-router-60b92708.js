import{t,f as e,u as n,s as r,d as o,a as s,D as a,g as c,h as i,b as u,l,c as h}from"./index-dab64add.js";function d(t){return t.split("/").map(f).join("/")}const p=/%|\//g;function f(t){return t.length<3||-1===t.indexOf("%")?t:decodeURIComponent(t).replace(p,encodeURIComponent)}const m=/%(?:2(?:4|6|B|C)|3(?:B|D|A)|40)/g;function g(t){return encodeURIComponent(t).replace(m,decodeURIComponent)}var S;!function(t){t[t.ANY=-1]="ANY",t[t.STAR=42]="STAR",t[t.SLASH=47]="SLASH",t[t.COLON=58]="COLON"}(S||(S={}));const y=/(\/|\.|\*|\+|\?|\||\(|\)|\[|\]|\{|\}|\\)/g,D=Array.isArray,A=Object.prototype.hasOwnProperty;function v(t,e){if("object"!=typeof t||null===t)throw new Error("You must pass an object as the second argument to `generate`.");if(!A.call(t,e))throw new Error("You must provide param `"+e+"` to `generate`.");const n=t[e],r="string"==typeof n?n:""+n;if(0===r.length)throw new Error("You must provide a param `"+e+"`.");return r}var E,w;!function(t){t[t.Static=0]="Static",t[t.Dynamic=1]="Dynamic",t[t.Star=2]="Star",t[t.Epsilon=4]="Epsilon"}(E||(E={})),function(t){t[t.Static=E.Static]="Static",t[t.Dynamic=E.Dynamic]="Dynamic",t[t.Star=E.Star]="Star",t[t.Epsilon=E.Epsilon]="Epsilon",t[t.Named=E.Dynamic|E.Star]="Named",t[t.Decoded=E.Dynamic]="Decoded",t[t.Counted=E.Static|E.Dynamic|E.Star]="Counted"}(w||(w={}));const x=[];x[E.Static]=function(t,e){let n=e;const r=t.value;for(let t=0;t<r.length;t++){const e=r.charCodeAt(t);n=n.put(e,!1,!1)}return n},x[E.Dynamic]=function(t,e){return e.put(S.SLASH,!0,!0)},x[E.Star]=function(t,e){return e.put(S.ANY,!1,!0)},x[E.Epsilon]=function(t,e){return e};const C=[];C[E.Static]=function(t){return t.value.replace(y,"\\$1")},C[E.Dynamic]=function(){return"([^/]+)"},C[E.Star]=function(){return"(.+)"},C[E.Epsilon]=function(){return""};const N=[];N[E.Static]=function(t){return t.value},N[E.Dynamic]=function(t,e,n){const r=v(e,t.value);return n?g(r):r},N[E.Star]=function(t,e){return v(e,t.value)},N[E.Epsilon]=function(){return""};const O=Object.freeze({}),b=Object.freeze([]);function R(t,e,n){e.length>0&&e.charCodeAt(0)===S.SLASH&&(e=e.substr(1));const r=e.split("/");let o=void 0,s=void 0;for(let e=0;e<r.length;e++){let a=r[e],c=0;c=""===a?E.Epsilon:a.charCodeAt(0)===S.COLON?E.Dynamic:a.charCodeAt(0)===S.STAR?E.Star:E.Static,c&w.Named&&(a=a.slice(1),o=o||[],o.push(a),s=s||[],s.push(0!=(c&w.Decoded))),c&w.Counted&&n[c]++,t.push({type:c,value:f(a)})}return{names:o||b,shouldDecodes:s||b}}function _(t,e,n){return t.char===e&&t.negate===n}class L{constructor(t,e,n,r,o){this.states=t,this.id=e,this.char=n,this.negate=r,this.nextStates=o?e:null,this.pattern="",this._regex=void 0,this.handlers=void 0,this.types=void 0}regex(){return this._regex||(this._regex=new RegExp(this.pattern)),this._regex}get(t,e){const n=this.nextStates;if(null!==n)if(D(n))for(let r=0;r<n.length;r++){const o=this.states[n[r]];if(_(o,t,e))return o}else{const r=this.states[n];if(_(r,t,e))return r}}put(t,e,n){let r;if(r=this.get(t,e))return r;const o=this.states;return r=new L(o,o.length,t,e,n),o[o.length]=r,null==this.nextStates?this.nextStates=r.id:D(this.nextStates)?this.nextStates.push(r.id):this.nextStates=[this.nextStates,r.id],r}match(t){const e=this.nextStates;if(!e)return[];const n=[];if(D(e))for(let r=0;r<e.length;r++){const o=this.states[e[r]];Y(o,t)&&n.push(o)}else{const r=this.states[e];Y(r,t)&&n.push(r)}return n}}function Y(t,e){return t.negate?t.char!==e&&t.char!==S.ANY:t.char===e||t.char===S.ANY}function j(t,e){let n=[];for(let r=0,o=t.length;r<o;r++){const o=t[r];n=n.concat(o.match(e))}return n}function P(t){let e;t=t.replace(/\+/gm,"%20");try{e=decodeURIComponent(t)}catch(t){e=""}return e}class U{constructor(){const t=[],e=new L(t,0,S.ANY,!0,!1);t[0]=e,this.rootState=e}static ENCODE_AND_DECODE_PATH_SEGMENTS=!0;static Normalizer={normalizeSegment:f,normalizePath:d,encodePathSegment:g};add(t,e){let n=this.rootState,r="^";const o=[0,0,0],s=new Array(t.length),a=[];let c=!0,i=0;for(let e=0;e<t.length;e++){const u=t[e],{names:l,shouldDecodes:h}=R(a,u.path,o);for(;i<a.length;i++){const t=a[i];t.type!==E.Epsilon&&(c=!1,n=n.put(S.SLASH,!1,!1),r+="/",n=x[t.type](t,n),r+=C[t.type](t))}s[e]={handler:u.handler,names:l,shouldDecodes:h}}c&&(n=n.put(S.SLASH,!1,!1),r+="/"),n.handlers=s,n.pattern=r+"$",n.types=o}recognize(t){const e=U.ENCODE_AND_DECODE_PATH_SEGMENTS;let n,r=[this.rootState],o={},s=!1;const a=t.indexOf("#");-1!==a&&(t=t.substr(0,a));const c=t.indexOf("?");if(-1!==c){const e=t.substr(c+1,t.length);t=t.substr(0,c),o=function(t){const e=t.split("&"),n={};for(let t=0;t<e.length;t++){const r=e[t].split("=");let o=P(r[0]);const s=o.length;let a,c=!1;1===r.length?a="true":(s>2&&o.endsWith("[]")&&(c=!0,o=o.slice(0,s-2),n[o]||(n[o]=[])),a=r[1]?P(r[1]):""),c?n[o].push(a):n[o]=a}return n}(e)}t.startsWith("/")||(t="/"+t);let i=t;e?t=d(t):(t=decodeURI(t),i=decodeURI(i));const u=t.length;u>1&&"/"===t.charAt(u-1)&&(t=t.substr(0,u-1),i=i.substr(0,i.length-1),s=!0);for(let e=0;e<t.length&&(r=j(r,t.charCodeAt(e)),r.length);e++);const l=[];for(let t=0;t<r.length;t++)r[t].handlers&&l.push(r[t]);r=function(t){return t.sort((function(t,e){const[n,r,o]=t.types||[0,0,0],[s,a,c]=e.types||[0,0,0];if(o!==c)return o-c;if(o){if(n!==s)return s-n;if(r!==a)return a-r}return r!==a?r-a:n!==s?s-n:0}))}(l);const h=l[0];return h&&h.handlers&&(s&&h.char===S.ANY&&(i+="/"),n=function(t,e,n,r){const o=t.handlers,s=t.regex();if(!s||!o)throw new Error("state not initialized");const a=s.exec(e);let c=1;const i=function(t){const e=[];return e.queryParams=t||{},e}(n);i.length=o.length;for(let t=0;t<o.length;t++){const e=o[t],n=e.names,s=e.shouldDecodes;let u=O,l=!1;if(n!==b&&s!==b)for(let t=0;t<n.length;t++){l=!0;const e=n[t],o=a&&a[c++];u===O&&(u={}),r&&s[t]?u[e]=o&&decodeURIComponent(o):u[e]=o}i[t]={handler:e.handler,params:u,isDynamic:l}}return i}(h,i,o,e)),n}}const q=t("<a></a>",2),z=h();function H(){return n(z)}function I(t){const{router:e,level:n}=H(),r=o((t=>{const r=e.current;let o={component:void 0,data:void 0,params:void 0,query:void 0,handler:r};return r&&r[n]&&(o.component=r[n].handler.component,o.params=r[n].params,o.query=r.queryParams,t&&t.handler===r||!r[n].handler.data||(o.data=r[n].handler.data({params:o.params,query:o.query}))),o}),void 0,!0);return s(z.Provider,{value:{level:n+1,router:e},get children(){return s(a,c({get component(){return r().component},get params(){return r().params},get query(){return r().query}},Object.keys(r().data||{}).reduce(((t,e)=>(t[e]=()=>(r().data||{})[e],i(t,e))),{}),Object.keys(t).reduce(((e,n)=>(e[n]=()=>t[n],i(e,n))),{}),{}))}})}const T=t=>{const{router:e}=H();return(()=>{const n=q.cloneNode(!0);return n.__click=n=>{n.preventDefault(),e.push(t.href||"")},r(n,t,!1,!1),n})()},k=t=>{const e=function(t,e,n=""){const r=new U;B(r,t,n);const[s,a]=u(e||window.location.pathname+window.location.search),c=o((()=>r.recognize(s())));return globalThis.window&&(window.onpopstate=()=>a(window.location.pathname)),{get location(){return s()},get current(){return c()},push(t){window.history.pushState("","",t),a(t)}}}(t.routes,t.initialURL,t.root);return s(z.Provider,{value:{level:0,router:e},get children(){return t.children}})};function B(t,e,n,r=[]){e.forEach((e=>{const o={path:e.path,handler:{component:l((()=>import(n+e.component))),data:e.data}};if(!e.children)return t.add([...r,o]);B(t,e.children,n,[...r,o])}))}e(["click"]);export{T as L,I as R,k as a,H as u};
